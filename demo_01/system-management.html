<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>系统管理 - H-System EDR平台</title>
    <style>
        /* 基础样式 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Microsoft YaHei", sans-serif;
        }

        body {
            display: flex;
            height: 100vh;
            overflow: hidden;
            background-color: #f5f7fa;
        }

        /* 左侧菜单栏 */
        .sidebar {
            width: 220px;
            background-color: #2c3e50;
            color: white;
            height: 100%;
            transition: all 0.3s;
            overflow-y: auto;
        }

        .sidebar-header {
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid #34495e;
        }

        .sidebar-header h1 {
            font-size: 18px;
            font-weight: 600;
        }
        /* 清除可能的浮动影响 */
        .sidebar:after, .main-container:after {
            content: "";
            display: table;
            clear: both;
        }

        .menu-item {
            padding: 15px 20px;
            cursor: pointer;
            transition: background-color 0.2s;
            display: flex;
            align-items: center;
            justify-content: flex-start;
            border-left: 3px solid transparent;
            text-decoration: none;
            color: white;
            position: relative; /* 添加相对定位 */
        }

        .menu-item:hover {
            background-color: #34495e;
        }

        .menu-item.active {
            background-color: #34495e;
            border-left-color: #3498db;
        }

        .menu-item i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }
        
        .expand-icon {
            margin-left: auto;
            transition: transform 0.3s;
        }
        .tree-node.expanded > .menu-item .expand-icon {
            transform: rotate(90deg);
        }
        
        /* 树状子菜单样式 */
        .menu-tree {
            list-style: none;
        }
        
        .tree-node {
            position: relative; /* 为子元素提供定位上下文 */
        }
        
        .tree-node.has-children > .menu-item {
            padding-right: 40px; /* 为展开图标预留空间 */
        }
        
        .tree-node.has-children > .menu-item::after {
            content: "";
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-left: 5px solid white;
            border-top: 5px solid transparent;
            border-bottom: 5px solid transparent;
            transition: transform 0.3s;
            z-index: 1; /* 确保图标在文字上方 */
        }
        
        .tree-node.expanded > .menu-item::after {
            transform: translateY(-50%) rotate(90deg);
        }
        
        .tree-children {
            background-color: #1a2530;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        
        .tree-node.expanded > .tree-children {
            max-height: 1000px; /* A sufficiently large value */
            transition: max-height 0.5s ease-in;
        }
        
        /* 层级缩进 */
        .tree-children .tree-node > .menu-item {
            padding-left: 60px;   /* 原为 40px，增加 10px 以对齐文字 */
        }
        .tree-children .tree-children .tree-node > .menu-item {
            padding-left: 80px;   /* 原为 60px */
        }
        .tree-children .tree-children .tree-children .tree-node > .menu-item {
            padding-left: 100px;   /* 原为 80px */
        }
        
        /* 右侧主内容区 */
        .main-container {
            flex: 1;
            min-width: 0; /* 解决flex容器子元素溢出问题 */
            width: calc(100% - 220px); /* 固定宽度，与侧边栏宽度互补 */
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            height: 100%;
            overflow: hidden;
        }

        .top-bar {
            height: 60px;
            background-color: white;
            border-bottom: 1px solid #ecf0f1;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .user-info {
            display: flex;
            align-items: center;
        }

        .user-info img {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            margin-right: 10px;
            background-color: #ecf0f1;
        }

        .content-area {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background-color: #f5f7fa;
        }

        /* 页面通用样式 */
        .page-title {
            font-size: 22px;
            margin-bottom: 20px;
            color: #2c3e50;
            font-weight: 600;
        }

        .card {
            background-color: white;
            border-radius: 6px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            padding: 20px;
            margin-bottom: 20px;
        }

        .panel-header {
            padding-bottom: 15px;
            margin-bottom: 15px;
            border-bottom: 1px solid #ecf0f1;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .panel-title {
            font-size: 16px;
            font-weight: 600;
            color: #2c3e50;
        }

        .panel-actions {
            display: flex;
            gap: 10px;
        }

        /* 表单样式 */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #495057;
            font-size: 14px;
        }

        .form-control {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            transition: border-color 0.2s;
        }

        .form-control:focus {
            border-color: #3498db;
            outline: none;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }

        textarea.form-control {
            min-height: 100px;
            resize: vertical;
        }

        .form-hint {
            margin-top: 5px;
            font-size: 12px;
            color: #6c757d;
        }

        /* 按钮样式 */
        .btn {
            padding: 6px 12px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .btn-primary {
            background-color: #3498db;
            color: white;
        }

        .btn-primary:hover {
            background-color: #2980b9;
        }

        .btn-danger {
            background-color: #e74c3c;
            color: white;
        }

        .btn-danger:hover {
            background-color: #c0392b;
        }

        .btn-warning {
            background-color: #f39c12;
            color: white;
        }

        .btn-warning:hover {
            background-color: #d35400;
        }

        .btn-outline {
            background-color: transparent;
            border: 1px solid #3498db;
            color: #3498db;
        }

        .btn-outline:hover {
            background-color: #3498db;
            color: white;
        }

        .btn-sm {
            padding: 3px 8px;
            font-size: 13px;
        }

        /* 表格样式 */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }

        .data-table th,
        .data-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #f1f3f5;
        }

        .data-table th {
            background-color: #f8fafc;
            font-weight: 600;
            color: #495057;
        }

        .data-table tr:hover {
            background-color: #f8fafc;
        }

        .table-actions {
            display: flex;
            gap: 5px;
        }

        /* 分页样式 */
        .pagination {
            display: flex;
            justify-content: center;
            margin-top: 20px;
            gap: 5px;
        }

        .page-btn {
            padding: 5px 12px;
            border-radius: 4px;
            border: 1px solid #ddd;
            background-color: white;
            cursor: pointer;
            transition: all 0.2s;
        }

        .page-btn:hover {
            border-color: #3498db;
            color: #3498db;
        }

        .page-btn.active {
            background-color: #3498db;
            color: white;
            border-color: #3498db;
        }

        /* 标签样式 */
        .tag {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }

        .tag-success {
            background-color: #dcfce7;
            color: #166534;
        }

        .tag-warning {
            background-color: #fef3c7;
            color: #d97706;
        }

        .tag-danger {
            background-color: #fee2e2;
            color: #b91c1c;
        }

        .tag-info {
            background-color: #dbeafe;
            color: #1e40af;
        }

        /* 弹窗样式 */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background-color: white;
            border-radius: 6px;
            width: 90%;
            max-width: 600px;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }

        .modal-header {
            padding: 15px 20px;
            border-bottom: 1px solid #ecf0f1;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            font-size: 18px;
            color: #2c3e50;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: #666;
        }

        .modal-body {
            padding: 20px;
        }

        .modal-footer {
            padding: 15px 20px;
            border-top: 1px solid #ecf0f1;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        /* 管理页面内容样式 */
        .management-content {
            display: none;
        }

        .management-content.active {
            display: block;
        }

        /* 系统状态样式 */
        .system-status {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .status-card {
            background-color: white;
            border-radius: 6px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border-left: 4px solid transparent;
        }

        .status-card.running {
            border-left-color: #27ae60;
        }

        .status-card.warning {
            border-left-color: #f39c12;
        }

        .status-card.error {
            border-left-color: #e74c3c;
        }

        .status-title {
            font-weight: 600;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
        }

        .status-value {
            color: #333;
            font-size: 14px;
        }

        .status-meta {
            margin-top: 10px;
            font-size: 12px;
            color: #666;
        }

        /* 权限矩阵样式 */
        .permission-matrix {
            overflow-x: auto;
        }

        .permission-row {
            display: flex;
            border-bottom: 1px solid #f1f3f5;
        }

        .permission-header {
            font-weight: 600;
            background-color: #f8fafc;
            padding: 10px;
            border-right: 1px solid #f1f3f5;
        }

        .permission-resource {
            min-width: 200px;
            padding: 10px;
            font-weight: 500;
            border-right: 1px solid #f1f3f5;
        }

        .permission-cell {
            min-width: 100px;
            padding: 10px;
            text-align: center;
            border-right: 1px solid #f1f3f5;
        }

        .permission-checkbox {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        /* 日志搜索区 */
        .log-filter {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 15px;
            align-items: flex-end;
        }

        .log-filter-group {
            flex: 1;
            min-width: 200px;
        }

        /* 提示消息样式 */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: rgba(0,0,0,0.7);
            color: white;
            padding: 10px 20px;
            border-radius: 4px;
            z-index: 9999;
            animation: fadeIn 0.3s, fadeOut 0.3s 2.7s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }

        /* 进度指示器 */
        .progress-container {
            margin-top: 5px;
            height: 6px;
            background-color: #e2e8f0;
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            transition: width 0.3s;
        }

        .progress-success {
            background-color: #27ae60;
        }

        .progress-warning {
            background-color: #f39c12;
        }

        .progress-danger {
            background-color: #e74c3c;
        }

        /* 图表容器 */
        .chart-container {
            height: 300px;
            margin-bottom: 20px;
        }
    </style>
    <!-- 引入Font Awesome图标库 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- 引入Chart.js用于图表展示 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- 左侧菜单栏 -->
    <div class="sidebar">
        <div class="sidebar-header">
            <h1>H-System EDR平台</h1>
        </div>
        <ul class="menu-tree">
            <li class="tree-node">
                <a href="index.html" class="menu-item">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>安全态势</span>
                </a>
            </li>
            <li class="tree-node">
                <a href="alert-center.html" class="menu-item">
                    <i class="fas fa-exclamation-triangle"></i>
                    <span>告警中心</span>
                </a>
            </li>
            <li class="tree-node">
                <a href="investigation.html" class="menu-item">
                    <i class="fas fa-search"></i>
                    <span>调查与响应</span>
                </a>
            </li>
            <li class="tree-node">
                <a href="asset-management.html" class="menu-item">
                    <i class="fas fa-desktop"></i>
                    <span>资产管理</span>
                </a>
            </li>
            <li class="tree-node">
                <a href="threat-hunting.html" class="menu-item">
                    <i class="fas fa-crosshairs"></i>
                    <span>威胁狩猎</span>
                </a>
            </li>
            <li class="tree-node">
                <a href="threat-intelligence.html" class="menu-item">
                    <i class="fas fa-shield-alt"></i>
                    <span>威胁情报</span>
                </a>
            </li>
            <li class="tree-node">
                <a href="report-center.html" class="menu-item">
                    <i class="fas fa-file-alt"></i>
                    <span>报告中心</span>
                </a>
            </li>
            
            <!-- 系统管理菜单 - 树状结构 -->
            <li class="tree-node has-children expanded">
                <div class="menu-item active">
                    <i class="fas fa-cog"></i>
                    <span>系统管理</span>
                </div>
                <ul class="tree-children">
                    <li class="tree-node">
                        <div class="menu-item active" data-target="system-status">
                            <span>系统状态</span>
                        </div>
                    </li>
                    <li class="tree-node">
                        <div class="menu-item" data-target="system-settings">
                            <span>系统设置</span>
                        </div>
                    </li>
                    
                    <li class="tree-node has-children">
                        <div class="menu-item">
                            <span>蜜罐策略中心</span>
                        </div>
                        <ul class="tree-children">
                            <li class="tree-node">
                                <div class="menu-item" data-target="honeypot-sensors">
                                    <span>蜜罐探针管理</span>
                                </div>
                            </li>
                            <li class="tree-node">
                                <div class="menu-item" data-target="honeypot-policies">
                                    <span>蜜罐策略配置</span>
                                </div>
                            </li>
                        </ul>
                    </li>
                    
                    <li class="tree-node has-children">
                        <div class="menu-item">
                            <span>用户与权限</span>
                        </div>
                        <ul class="tree-children">
                            <li class="tree-node">
                                <div class="menu-item" data-target="user-management">
                                    <span>用户管理</span>
                                </div>
                            </li>
                            <li class="tree-node">
                                <div class="menu-item" data-target="role-permission">
                                    <span>角色与权限</span>
                                </div>
                            </li>
                        </ul>
                    </li>
                    
                    <li class="tree-node has-children">
                        <div class="menu-item">
                            <span>系统维护</span>
                        </div>
                        <ul class="tree-children">
                            <li class="tree-node">
                                <div class="menu-item" data-target="log-audit">
                                    <span>日志审计</span>
                                </div>
                            </li>
                            <li class="tree-node">
                                <div class="menu-item" data-target="update-management">
                                    <span>更新管理</span>
                                </div>
                            </li>
                            <li class="tree-node">
                                <div class="menu-item" data-target="backup-restore">
                                    <span>备份与恢复</span>
                                </div>
                            </li>
                        </ul>
                    </li>
                </ul>
            </li>
        </ul>
    </div>

    <!-- 右侧主内容区 -->
    <div class="main-container">
        <div class="top-bar">
            <div class="breadcrumbs">当前位置: 系统管理 / <span id="management-breadcrumb">系统状态</span></div>
            <div class="user-info">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='30' r='20' fill='%233498db'/%3E%3Cpath d='M10,90 C10,65 30,55 50,55 C70,55 90,65 90,90' fill='%233498db'/%3E%3C/svg%3E" alt="用户头像">
                <span>管理员</span>
                <button class="btn btn-outline btn-sm" style="margin-left: 15px;" onclick="showToast('已退出登录')"><i class="fas fa-sign-out-alt"></i> 退出</button>
            </div>
        </div>

        <div class="content-area">
            <h2 class="page-title">系统管理中心</h2>

            <!-- 系统状态 -->
            <div id="system-status" class="management-content active">
                <div class="system-status">
                    <div class="status-card running">
                        <div class="status-title">
                            <span>服务状态</span>
                            <span class="tag tag-success">运行中</span>
                        </div>
                        <div class="status-value">所有核心服务正常运行</div>
                        <div class="status-meta">最后检查: 2分钟前</div>
                    </div>
                    <div class="status-card running">
                        <div class="status-title">
                            <span>数据库状态</span>
                            <span class="tag tag-success">正常</span>
                        </div>
                        <div class="status-value">连接正常，性能良好</div>
                        <div class="status-meta">连接数: 24，查询响应: 32ms</div>
                    </div>
                    <div class="status-card warning">
                        <div class="status-title">
                            <span>磁盘空间</span>
                            <span class="tag tag-warning">警告</span>
                        </div>
                        <div class="status-value">可用空间 18%</div>
                        <div class="progress-container">
                            <div class="progress-bar progress-warning" style="width: 82%;"></div>
                        </div>
                        <div class="status-meta">总容量: 500GB，已使用: 410GB</div>
                    </div>
                    <div class="status-card running">
                        <div class="status-title">
                            <span>CPU 使用率</span>
                            <span class="tag tag-success">正常</span>
                        </div>
                        <div class="status-value">32%</div>
                        <div class="progress-container">
                            <div class="progress-bar progress-success" style="width: 32%;"></div>
                        </div>
                        <div class="status-meta">8核处理器，负载均衡</div>
                    </div>
                    <div class="status-card running">
                        <div class="status-title">
                            <span>内存使用率</span>
                            <span class="tag tag-success">正常</span>
                        </div>
                        <div class="status-value">45%</div>
                        <div class="progress-container">
                            <div class="progress-bar progress-success" style="width: 45%;"></div>
                        </div>
                        <div class="status-meta">总内存: 32GB，已使用: 14.4GB</div>
                    </div>
                    <div class="status-card running">
                        <div class="status-title">
                            <span>终端在线率</span>
                            <span class="tag tag-success">良好</span>
                        </div>
                        <div class="status-value">96%</div>
                        <div class="progress-container">
                            <div class="progress-bar progress-success" style="width: 96%;"></div>
                        </div>
                        <div class="status-meta">总终端: 250台，在线: 240台</div>
                    </div>
                </div>

                <div class="card">
                    <div class="panel-header">
                        <div class="panel-title">系统资源监控</div>
                        <select class="form-control" style="width: auto;" onchange="updateResourceChart(this.value)">
                            <option value="1h">近1小时</option>
                            <option value="24h">近24小时</option>
                            <option value="7d">近7天</option>
                        </select>
                    </div>
                    <div class="chart-container">
                        <canvas id="resourceMonitoringChart"></canvas>
                    </div>
                </div>
                
                <div class="card">
                    <div class="panel-header">
                        <div class="panel-title">CPU核心使用率监控</div>
                        <select class="form-control" style="width: auto;" onchange="updateCPUCoreChart(this.value)">
                            <option value="1h">近1小时</option>
                            <option value="24h" selected>近24小时</option>
                            <option value="7d">近7天</option>
                        </select>
                    </div>
                    <div class="chart-container">
                        <canvas id="cpuCoreChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <div class="panel-header">
                        <div class="panel-title">服务列表</div>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>服务名称</th>
                                <th>状态</th>
                                <th>进程ID</th>
                                <th>占用内存</th>
                                <th>启动时间</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>核心服务</td>
                                <td><span class="tag tag-success">运行中</span></td>
                                <td>1245</td>
                                <td>896 MB</td>
                                <td>2025-08-20 08:30:15</td>
                                <td class="table-actions">
                                    <button class="btn btn-outline btn-sm" onclick="restartService('核心服务')"><i class="fas fa-sync-alt"></i> 重启</button>
                                </td>
                            </tr>
                            <tr>
                                <td>数据库服务</td>
                                <td><span class="tag tag-success">运行中</span></td>
                                <td>1289</td>
                                <td>2.4 GB</td>
                                <td>2025-08-20 08:31:02</td>
                                <td class="table-actions">
                                    <button class="btn btn-outline btn-sm" onclick="restartService('数据库服务')"><i class="fas fa-sync-alt"></i> 重启</button>
                                </td>
                            </tr>
                            <tr>
                                <td>告警服务</td>
                                <td><span class="tag tag-success">运行中</span></td>
                                <td>1356</td>
                                <td>512 MB</td>
                                <td>2025-08-20 08:32:45</td>
                                <td class="table-actions">
                                    <button class="btn btn-outline btn-sm" onclick="restartService('告警服务')"><i class="fas fa-sync-alt"></i> 重启</button>
                                </td>
                            </tr>
                            <tr>
                                <td>威胁情报服务</td>
                                <td><span class="tag tag-success">运行中</span></td>
                                <td>1421</td>
                                <td>1.2 GB</td>
                                <td>2025-08-20 08:33:18</td>
                                <td class="table-actions">
                                    <button class="btn btn-outline btn-sm" onclick="restartService('威胁情报服务')"><i class="fas fa-sync-alt"></i> 重启</button>
                                </td>
                            </tr>
                            <tr>
                                <td>升级服务</td>
                                <td><span class="tag tag-warning">已停止</span></td>
                                <td>-</td>
                                <td>0 MB</td>
                                <td>-</td>
                                <td class="table-actions">
                                    <button class="btn btn-primary btn-sm" onclick="startService('升级服务')"><i class="fas fa-play"></i> 启动</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- 系统设置 -->
            <div id="system-settings" class="management-content">
                <div class="card">
                    <div class="panel-header">
                        <div class="panel-title">基本设置</div>
                    </div>
                    <form id="basic-settings-form">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="system-name">系统名称</label>
                                <input type="text" id="system-name" class="form-control" value="H-System EDR平台">
                                <div class="form-hint">显示在浏览器标题和登录页面的系统名称</div>
                            </div>
                            <div class="form-group">
                                <label for="system-timezone">系统时区</label>
                                <select id="system-timezone" class="form-control">
                                    <option value="Asia/Shanghai" selected>Asia/Shanghai (UTC+8)</option>
                                    <option value="UTC">UTC</option>
                                    <option value="America/New_York">America/New_York (UTC-5)</option>
                                    <option value="Europe/London">Europe/London (UTC±0)</option>
                                </select>
                                <div class="form-hint">系统时间所使用的时区</div>
                            </div>
                            <div class="form-group">
                                <label for="session-timeout">会话超时时间</label>
                                <select id="session-timeout" class="form-control">
                                    <option value="30">30分钟</option>
                                    <option value="60" selected>1小时</option>
                                    <option value="120">2小时</option>
                                    <option value="240">4小时</option>
                                    <option value="480">8小时</option>
                                </select>
                                <div class="form-hint">用户无操作时自动登出的时间</div>
                            </div>
                            <div class="form-group">
                                <label for="language">系统语言</label>
                                <select id="language" class="form-control">
                                    <option value="zh-CN" selected>简体中文</option>
                                    <option value="en-US">English</option>
                                </select>
                                <div class="form-hint">系统界面显示的语言</div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="system-description">系统描述</label>
                            <textarea id="system-description" class="form-control">H-System EDR平台是一款企业级终端检测与响应解决方案，提供全面的终端安全防护能力。</textarea>
                            <div class="form-hint">显示在登录页面的系统描述信息</div>
                        </div>

                        <div class="panel-actions">
                            <button type="button" class="btn btn-primary" onclick="saveSettings('basic')"><i class="fas fa-save"></i> 保存设置</button>
                        </div>
                    </form>
                </div>

                <div class="card">
                    <div class="panel-header">
                        <div class="panel-title">告警设置</div>
                    </div>
                    <form id="alert-settings-form">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="alert-level">默认告警级别阈值</label>
                                <select id="alert-level" class="form-control">
                                    <option value="low">低 - 所有可疑行为</option>
                                    <option value="medium" selected>中 - 确认的威胁行为</option>
                                    <option value="high">高 - 严重的威胁行为</option>
                                </select>
                                <div class="form-hint">系统默认生成告警的敏感度级别</div>
                            </div>
                            <div class="form-group">
                                <label for="alert-forwarding">告警转发</label>
                                <select id="alert-forwarding" class="form-control">
                                    <option value="none">不转发</option>
                                    <option value="syslog">通过Syslog转发</option>
                                    <option value="email" selected>通过邮件转发</option>
                                    <option value="both">同时通过Syslog和邮件转发</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="email-recipient">告警接收邮箱</label>
                                <input type="email" id="email-recipient" class="form-control" value="security@example.com,admin@example.com">
                                <div class="form-hint">多个邮箱地址用逗号分隔</div>
                            </div>
                            <div class="form-group">
                                <label for="alert-frequency">告警聚合频率</label>
                                <select id="alert-frequency" class="form-control">
                                    <option value="immediate">立即发送</option>
                                    <option value="5min">每5分钟聚合</option>
                                    <option value="15min" selected>每15分钟聚合</option>
                                    <option value="hourly">每小时聚合</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>告警通知方式</label>
                            <div style="display: flex; gap: 15px; margin-top: 8px;">
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="checkbox" checked> 系统内通知
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="checkbox" checked> 邮件通知
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="checkbox"> 短信通知
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="checkbox"> 企业微信通知
                                </label>
                            </div>
                        </div>

                        <div class="panel-actions">
                            <button type="button" class="btn btn-primary" onclick="saveSettings('alert')"><i class="fas fa-save"></i> 保存设置</button>
                        </div>
                    </form>
                </div>

                <div class="card">
                    <div class="panel-header">
                        <div class="panel-title">威胁情报源设置</div>
                    </div>
                    <form id="intelligence-settings-form">
                        <div class="form-group">
                            <label>启用的情报源</label>
                            <div style="margin-top: 10px;">
                                <div style="display: flex; align-items: center; margin-bottom: 10px; padding: 10px; background-color: #f8fafc; border-radius: 4px;">
                                    <input type="checkbox" checked style="margin-right: 10px;">
                                    <div style="flex: 1;">
                                        <div style="font-weight: 500;">内置威胁情报库</div>
                                        <div style="font-size: 12px; color: #666;">系统内置的基础威胁情报数据</div>
                                    </div>
                                </div>
                                <div style="display: flex; align-items: center; margin-bottom: 10px; padding: 10px; background-color: #f8fafc; border-radius: 4px;">
                                    <input type="checkbox" checked style="margin-right: 10px;">
                                    <div style="flex: 1;">
                                        <div style="font-weight: 500;">第三方商业情报源</div>
                                        <div style="font-size: 12px; color: #666;">通过API同步的外部商业威胁情报</div>
                                    </div>
                                </div>
                                <div style="display: flex; align-items: center; margin-bottom: 10px; padding: 10px; background-color: #f8fafc; border-radius: 4px;">
                                    <input type="checkbox" style="margin-right: 10px;">
                                    <div style="flex: 1;">
                                        <div style="font-weight: 500;">开源威胁情报</div>
                                        <div style="font-size: 12px; color: #666;">来自开源社区的威胁情报数据</div>
                                    </div>
                                </div>
                                <div style="display: flex; align-items: center; margin-bottom: 10px; padding: 10px; background-color: #f8fafc; border-radius: 4px;">
                                    <input type="checkbox" checked style="margin-right: 10px;">
                                    <div style="flex: 1;">
                                        <div style="font-weight: 500;">本地自定义情报</div>
                                        <div style="font-size: 12px; color: #666;">管理员手动添加的自定义威胁情报</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="intelligence-update-frequency">情报更新频率</label>
                            <select id="intelligence-update-frequency" class="form-control">
                                <option value="hourly">每小时</option>
                                <option value="daily" selected>每天</option>
                                <option value="weekly">每周</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="intelligence-retention">情报保留时间</label>
                            <select id="intelligence-retention" class="form-control">
                                <option value="30">30天</option>
                                <option value="90" selected>90天</option>
                                <option value="180">180天</option>
                                <option value="365">1年</option>
                                <option value="forever">永久保留</option>
                            </select>
                        </div>

                        <div class="panel-actions">
                            <button type="button" class="btn btn-primary" onclick="saveSettings('intelligence')"><i class="fas fa-save"></i> 保存设置</button>
                            <button type="button" class="btn btn-outline" onclick="syncIntelligence()"><i class="fas fa-sync-alt"></i> 立即同步</button>
                        </div>
                    </form>
                </div>
            </div>

        <div class="content-area">
            <!-- 蜜罐探针管理 -->
            <div id="honeypot-sensors" class="management-content active">
                <h2 class="page-title">蜜罐探针管理</h2>
                <div class="card">
                    <div class="panel-header">
                        <div class="panel-title">探针列表</div>
                        <button class="btn btn-primary"><i class="fas fa-plus"></i> 部署新探针</button>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>探针ID</th>
                                <th>类型</th>
                                <th>部署位置/IP</th>
                                <th>状态</th>
                                <th>关联策略</th>
                                <th>捕获会话数</th>
                                <th>最近活动</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>SSH-Decoy-01</td>
                                <td>SSH蜜罐</td>
                                <td>10.10.10.5</td>
                                <td><span class="tag tag-success">在线</span></td>
                                <td>低交互-通用Linux</td>
                                <td>15</td>
                                <td>2分钟前</td>
                            </tr>
                            <tr>
                                <td>WEB-Decoy-01</td>
                                <td>Web蜜罐</td>
                                <td>10.10.10.6</td>
                                <td><span class="tag tag-danger">异常</span></td>
                                <td>Web应用-Struts2</td>
                                <td>128</td>
                                <td>1小时前</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- 蜜罐策略配置 -->
            <div id="honeypot-policies" class="management-content">
                <h2 class="page-title">蜜罐策略配置</h2>
                <div class="card">
                    <div class="panel-header">
                        <div class="panel-title">策略配置</div>
                    </div>
                    <div class="policy-layout">
                        <div class="policy-list">
                            <div class="policy-item active">低交互-通用Linux</div>
                            <div class="policy-item">高交互-Windows域控</div>
                            <div class="policy-item">Web应用-Struts2漏洞</div>
                        </div>
                        <div class="policy-editor">
                            <div class="form-group">
                                <label>策略名称</label>
                                <input type="text" class="form-control" value="低交互-通用Linux">
                            </div>
                            <div class="form-group">
                                <label>模拟服务类型</label>
                                <input type="text" class="form-control" value="SSH">
                            </div>
                            <div class="form-group">
                                <label>开放端口</label>
                                <input type="text" class="form-control" value="22">
                            </div>
                            <div class="form-group">
                                <label>Banner信息</label>
                                <input type="text" class="form-control" value="SSH-2.0-OpenSSH_7.6p1">
                            </div>
                            <button class="btn btn-primary">保存策略</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 用户管理 -->
            <div id="user-management" class="management-content">
                <div class="card">
                    <div class="panel-header">
                        <div class="panel-title">用户列表</div>
                        <button class="btn btn-primary" onclick="showUserModal()"><i class="fas fa-plus"></i> 添加用户</button>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <div style="display: flex; gap: 10px;">
                            <input type="text" class="form-control" placeholder="搜索用户名、姓名或邮箱..." style="max-width: 300px;">
                            <select class="form-control" style="max-width: 200px;">
                                <option value="all">所有角色</option>
                                <option value="admin">管理员</option>
                                <option value="analyst">安全分析师</option>
                                <option value="operator">操作员</option>
                                <option value="viewer">查看者</option>
                            </select>
                            <select class="form-control" style="max-width: 150px;">
                                <option value="all">所有状态</option>
                                <option value="active">启用</option>
                                <option value="inactive">禁用</option>
                            </select>
                            <button class="btn btn-outline"><i class="fas fa-search"></i> 搜索</button>
                        </div>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>用户名</th>
                                <th>姓名</th>
                                <th>邮箱</th>
                                <th>角色</th>
                                <th>状态</th>
                                <th>最后登录</th>
                                <th>创建时间</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>admin</td>
                                <td>系统管理员</td>
                                <td>admin@example.com</td>
                                <td>管理员</td>
                                <td><span class="tag tag-success">启用</span></td>
                                <td>2025-08-27 09:15:32</td>
                                <td>2025-05-10 14:30:00</td>
                                <td class="table-actions">
                                    <button class="btn btn-outline btn-sm" onclick="editUser('admin')"><i class="fas fa-edit"></i> 编辑</button>
                                    <button class="btn btn-outline btn-sm" onclick="resetPassword('admin')"><i class="fas fa-key"></i> 重置密码</button>
                                    <button class="btn btn-outline btn-sm" disabled><i class="fas fa-ban"></i> 禁用</button>
                                </td>
                            </tr>
                            <tr>
                                <td>security_analyst</td>
                                <td>安全分析师</td>
                                <td>analyst@example.com</td>
                                <td>安全分析师</td>
                                <td><span class="tag tag-success">启用</span></td>
                                <td>2025-08-26 16:42:18</td>
                                <td>2025-06-15 10:20:00</td>
                                <td class="table-actions">
                                    <button class="btn btn-outline btn-sm" onclick="editUser('security_analyst')"><i class="fas fa-edit"></i> 编辑</button>
                                    <button class="btn btn-outline btn-sm" onclick="resetPassword('security_analyst')"><i class="fas fa-key"></i> 重置密码</button>
                                    <button class="btn btn-danger btn-sm" onclick="disableUser('security_analyst')"><i class="fas fa-ban"></i> 禁用</button>
                                </td>
                            </tr>
                            <tr>
                                <td>operator_01</td>
                                <td>操作员小李</td>
                                <td>operator1@example.com</td>
                                <td>操作员</td>
                                <td><span class="tag tag-success">启用</span></td>
                                <td>2025-08-27 11:05:47</td>
                                <td>2025-07-02 09:15:00</td>
                                <td class="table-actions">
                                    <button class="btn btn-outline btn-sm" onclick="editUser('operator_01')"><i class="fas fa-edit"></i> 编辑</button>
                                    <button class="btn btn-outline btn-sm" onclick="resetPassword('operator_01')"><i class="fas fa-key"></i> 重置密码</button>
                                    <button class="btn btn-danger btn-sm" onclick="disableUser('operator_01')"><i class="fas fa-ban"></i> 禁用</button>
                                </td>
                            </tr>
                            <tr>
                                <td>viewer_01</td>
                                <td>查看员小王</td>
                                <td>viewer1@example.com</td>
                                <td>查看者</td>
                                <td><span class="tag tag-warning">禁用</span></td>
                                <td>2025-08-10 15:30:22</td>
                                <td>2025-07-10 16:45:00</td>
                                <td class="table-actions">
                                    <button class="btn btn-outline btn-sm" onclick="editUser('viewer_01')"><i class="fas fa-edit"></i> 编辑</button>
                                    <button class="btn btn-outline btn-sm" onclick="resetPassword('viewer_01')"><i class="fas fa-key"></i> 重置密码</button>
                                    <button class="btn btn-primary btn-sm" onclick="enableUser('viewer_01')"><i class="fas fa-check"></i> 启用</button>
                                </td>
                            </tr>
                            <tr>
                                <td>it_manager</td>
                                <td>IT经理</td>
                                <td>itmgr@example.com</td>
                                <td>安全分析师</td>
                                <td><span class="tag tag-success">启用</span></td>
                                <td>2025-08-25 14:20:15</td>
                                <td>2025-07-20 11:30:00</td>
                                <td class="table-actions">
                                    <button class="btn btn-outline btn-sm" onclick="editUser('it_manager')"><i class="fas fa-edit"></i> 编辑</button>
                                    <button class="btn btn-outline btn-sm" onclick="resetPassword('it_manager')"><i class="fas fa-key"></i> 重置密码</button>
                                    <button class="btn btn-danger btn-sm" onclick="disableUser('it_manager')"><i class="fas fa-ban"></i> 禁用</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="pagination">
                        <button class="page-btn"><i class="fas fa-chevron-left"></i></button>
                        <button class="page-btn active">1</button>
                        <button class="page-btn">2</button>
                        <button class="page-btn">3</button>
                        <button class="page-btn"><i class="fas fa-chevron-right"></i></button>
                    </div>
                </div>
            </div>

            <!-- 角色与权限 -->
            <div id="role-permission" class="management-content">
                <div class="card">
                    <div class="panel-header">
                        <div class="panel-title">角色列表</div>
                        <button class="btn btn-primary" onclick="showRoleModal()"><i class="fas fa-plus"></i> 创建角色</button>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>角色名称</th>
                                <th>描述</th>
                                <th>用户数量</th>
                                <th>创建时间</th>
                                <th>最后修改</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>管理员</td>
                                <td>系统最高权限，可访问和管理所有功能</td>
                                <td>1</td>
                                <td>2025-05-10</td>
                                <td>2025-05-10</td>
                                <td class="table-actions">
                                    <button class="btn btn-outline btn-sm" onclick="editRole('管理员')"><i class="fas fa-edit"></i> 编辑</button>
                                    <button class="btn btn-outline btn-sm" onclick="viewRoleUsers('管理员')"><i class="fas fa-users"></i> 查看用户</button>
                                    <button class="btn btn-outline btn-sm" disabled><i class="fas fa-trash"></i> 删除</button>
                                </td>
                            </tr>
                            <tr>
                                <td>安全分析师</td>
                                <td>可查看和分析安全事件，管理威胁情报</td>
                                <td>2</td>
                                <td>2025-05-10</td>
                                <td>2025-06-18</td>
                                <td class="table-actions">
                                    <button class="btn btn-outline btn-sm" onclick="editRole('安全分析师')"><i class="fas fa-edit"></i> 编辑</button>
                                    <button class="btn btn-outline btn-sm" onclick="viewRoleUsers('安全分析师')"><i class="fas fa-users"></i> 查看用户</button>
                                    <button class="btn btn-outline btn-sm" disabled><i class="fas fa-trash"></i> 删除</button>
                                </td>
                            </tr>
                            <tr>
                                <td>操作员</td>
                                <td>可处理告警和执行响应操作，有限的配置权限</td>
                                <td>1</td>
                                <td>2025-05-10</td>
                                <td>2025-07-05</td>
                                <td class="table-actions">
                                    <button class="btn btn-outline btn-sm" onclick="editRole('操作员')"><i class="fas fa-edit"></i> 编辑</button>
                                    <button class="btn btn-outline btn-sm" onclick="viewRoleUsers('操作员')"><i class="fas fa-users"></i> 查看用户</button>
                                    <button class="btn btn-outline btn-sm" disabled><i class="fas fa-trash"></i> 删除</button>
                                </td>
                            </tr>
                            <tr>
                                <td>查看者</td>
                                <td>只读权限，可查看安全态势和报告，无操作权限</td>
                                <td>1</td>
                                <td>2025-05-15</td>
                                <td>2025-05-15</td>
                                <td class="table-actions">
                                    <button class="btn btn-outline btn-sm" onclick="editRole('查看者')"><i class="fas fa-edit"></i> 编辑</button>
                                    <button class="btn btn-outline btn-sm" onclick="viewRoleUsers('查看者')"><i class="fas fa-users"></i> 查看用户</button>
                                    <button class="btn btn-danger btn-sm" onclick="deleteRole('查看者')"><i class="fas fa-trash"></i> 删除</button>
                                </td>
                            </tr>
                            <tr>
                                <td>审计员</td>
                                <td>可查看系统日志和审计信息，无配置和操作权限</td>
                                <td>0</td>
                                <td>2025-07-20</td>
                                <td>2025-07-20</td>
                                <td class="table-actions">
                                    <button class="btn btn-outline btn-sm" onclick="editRole('审计员')"><i class="fas fa-edit"></i> 编辑</button>
                                    <button class="btn btn-outline btn-sm" onclick="viewRoleUsers('审计员')"><i class="fas fa-users"></i> 查看用户</button>
                                    <button class="btn btn-danger btn-sm" onclick="deleteRole('审计员')"><i class="fas fa-trash"></i> 删除</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="card">
                    <div class="panel-header">
                        <div class="panel-title">权限矩阵</div>
                        <select class="form-control" style="width: auto;" onchange="loadRolePermissions(this.value)">
                            <option value="admin">管理员</option>
                            <option value="analyst">安全分析师</option>
                            <option value="operator">操作员</option>
                            <option value="viewer">查看者</option>
                            <option value="auditor">审计员</option>
                        </select>
                    </div>
                    <div class="permission-matrix">
                        <div class="permission-row">
                            <div class="permission-header" style="min-width: 200px;">功能模块</div>
                            <div class="permission-header">查看</div>
                            <div class="permission-header">创建</div>
                            <div class="permission-header">编辑</div>
                            <div class="permission-header">删除</div>
                            <div class="permission-header">导出</div>
                            <div class="permission-header">配置</div>
                        </div>
                        <div class="permission-row">
                            <div class="permission-resource">安全态势</div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked disabled></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" disabled></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" disabled></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" disabled></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                        </div>
                        <div class="permission-row">
                            <div class="permission-resource">资产管理</div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                        </div>
                        <div class="permission-row">
                            <div class="permission-resource">告警中心</div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                        </div>
                        <div class="permission-row">
                            <div class="permission-resource">调查与响应</div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                        </div>
                        <div class="permission-row">
                            <div class="permission-resource">威胁狩猎</div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                        </div>
                        <div class="permission-row">
                            <div class="permission-resource">威胁情报</div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                        </div>
                        <div class="permission-row">
                            <div class="permission-resource">系统管理</div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                            <div class="permission-cell"><input type="checkbox" class="permission-checkbox" checked></div>
                        </div>
                    </div>
                    <div class="panel-actions" style="margin-top: 15px;">
                        <button class="btn btn-primary" onclick="saveRolePermissions()"><i class="fas fa-save"></i> 保存权限设置</button>
                    </div>
                </div>
            </div>

            <!-- 日志审计 -->
            <div id="log-audit" class="management-content">
                <div class="card">
                    <div class="panel-header">
                        <div class="panel-title">系统操作日志</div>
                    </div>
                    <div class="log-filter">
                        <div class="log-filter-group">
                            <label for="log-user">操作用户</label>
                            <input type="text" id="log-user" class="form-control" placeholder="输入用户名...">
                        </div>
                        <div class="log-filter-group">
                            <label for="log-action">操作类型</label>
                            <select id="log-action" class="form-control">
                                <option value="all">所有操作</option>
                                <option value="login">登录</option>
                                <option value="logout">登出</option>
                                <option value="create">创建</option>
                                <option value="edit">编辑</option>
                                <option value="delete">删除</option>
                                <option value="query">查询</option>
                                <option value="config">配置修改</option>
                            </select>
                        </div>
                        <div class="log-filter-group">
                            <label for="log-result">操作结果</label>
                            <select id="log-result" class="form-control">
                                <option value="all">所有结果</option>
                                <option value="success">成功</option>
                                <option value="fail">失败</option>
                            </select>
                        </div>
                        <div class="log-filter-group">
                            <label for="log-start-time">开始时间</label>
                            <input type="datetime-local" id="log-start-time" class="form-control">
                        </div>
                        <div class="log-filter-group">
                            <label for="log-end-time">结束时间</label>
                            <input type="datetime-local" id="log-end-time" class="form-control">
                        </div>
                        <div style="margin-bottom: 15px;">
                            <button class="btn btn-primary" onclick="searchLogs()"><i class="fas fa-search"></i> 搜索</button>
                            <button class="btn btn-outline" onclick="resetLogFilters()"><i class="fas fa-sync-alt"></i> 重置</button>
                            <button class="btn btn-outline" onclick="exportLogs()"><i class="fas fa-download"></i> 导出</button>
                        </div>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>时间</th>
                                <th>用户</th>
                                <th>IP地址</th>
                                <th>操作类型</th>
                                <th>操作内容</th>
                                <th>结果</th>
                                <th>详情</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>2025-08-27 09:15:32</td>
                                <td>admin</td>
                                <td>192.168.1.100</td>
                                <td>登录</td>
                                <td>用户登录系统</td>
                                <td><span class="tag tag-success">成功</span></td>
                                <td>使用密码登录，浏览器: Chrome 120.0</td>
                            </tr>
                            <tr>
                                <td>2025-08-27 10:23:15</td>
                                <td>security_analyst</td>
                                <td>192.168.1.105</td>
                                <td>配置修改</td>
                                <td>更新告警阈值设置</td>
                                <td><span class="tag tag-success">成功</span></td>
                                <td>将告警级别阈值从"低"调整为"中"</td>
                            </tr>
                            <tr>
                                <td>2025-08-27 11:05:47</td>
                                <td>operator_01</td>
                                <td>192.168.1.110</td>
                                <td>登录</td>
                                <td>用户登录系统</td>
                                <td><span class="tag tag-success">成功</span></td>
                                <td>使用密码登录，浏览器: Firefox 118.0</td>
                            </tr>
                            <tr>
                                <td>2025-08-27 11:30:22</td>
                                <td>operator_01</td>
                                <td>192.168.1.110</td>
                                <td>创建</td>
                                <td>添加自定义威胁情报</td>
                                <td><span class="tag tag-success">成功</span></td>
                                <td>添加了IP地址: 185.234.76.123</td>
                            </tr>
                            <tr>
                                <td>2025-08-27 14:05:18</td>
                                <td>unknown</td>
                                <td>203.0.113.45</td>
                                <td>登录</td>
                                <td>用户登录系统</td>
                                <td><span class="tag tag-danger">失败</span></td>
                                <td>用户名或密码错误，尝试用户: admin</td>
                            </tr>
                            <tr>
                                <td>2025-08-27 14:20:35</td>
                                <td>admin</td>
                                <td>192.168.1.100</td>
                                <td>编辑</td>
                                <td>修改用户权限</td>
                                <td><span class="tag tag-success">成功</span></td>
                                <td>将用户it_manager从"操作员"改为"安全分析师"</td>
                            </tr>
                            <tr>
                                <td>2025-08-26 16:42:18</td>
                                <td>security_analyst</td>
                                <td>192.168.1.105</td>
                                <td>查询</td>
                                <td>导出威胁情报报告</td>
                                <td><span class="tag tag-success">成功</span></td>
                                <td>导出近7天的威胁情报数据，格式: PDF</td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="pagination">
                        <button class="page-btn"><i class="fas fa-chevron-left"></i></button>
                        <button class="page-btn active">1</button>
                        <button class="page-btn">2</button>
                        <button class="page-btn">3</button>
                        <button class="page-btn">4</button>
                        <button class="page-btn">5</button>
                        <button class="page-btn"><i class="fas fa-chevron-right"></i></button>
                    </div>
                </div>

                <div class="card">
                    <div class="panel-header">
                        <div class="panel-title">日志统计</div>
                        <select class="form-control" style="width: auto;" onchange="updateLogChart(this.value)">
                            <option value="day">按天</option>
                            <option value="week" selected>按周</option>
                            <option value="month">按月</option>
                        </select>
                    </div>
                    <div class="chart-container">
                        <canvas id="logStatisticsChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- 更新管理 -->
            <div id="update-management" class="management-content">
                <div class="card">
                    <div class="panel-header">
                        <div class="panel-title">系统版本信息</div>
                    </div>
                    <div style="padding: 10px 0;">
                        <div class="form-group">
                            <label>当前版本</label>
                            <div class="form-control" style="background-color: #f8fafc; border: none;">v2.5.3 (Build 20250815)</div>
                        </div>
                        <div class="form-group">
                            <label>安装日期</label>
                            <div class="form-control" style="background-color: #f8fafc; border: none;">2025-05-10</div>
                        </div>
                        <div class="form-group">
                            <label>最新版本</label>
                            <div class="form-control" style="background-color: #f8fafc; border: none; color: #e74c3c;">v2.6.0 (Build 20250825) - 有可用更新</div>
                        </div>
                        <div class="form-group">
                            <label>更新日志</label>
                            <div class="form-control" style="background-color: #f8fafc; min-height: 120px;">
                                <div style="margin-bottom: 8px; font-weight: 500;">v2.6.0 更新内容：</div>
                                <ul style="margin-left: 20px; line-height: 1.5;">
                                    <li>新增威胁狩猎自动化规则功能</li>
                                    <li>优化告警分析引擎，提高检测准确率</li>
                                    <li>增强威胁情报管理模块，支持多源情报聚合</li>
                                    <li>修复部分已知漏洞和稳定性问题</li>
                                    <li>改进用户界面，提升操作体验</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="panel-actions">
                        <button class="btn btn-primary" onclick="checkForUpdates()"><i class="fas fa-sync-alt"></i> 检查更新</button>
                        <button class="btn btn-warning" onclick="showUpdateModal()"><i class="fas fa-download"></i> 下载更新</button>
                    </div>
                </div>

                <div class="card">
                    <div class="panel-header">
                        <div class="panel-title">终端Agent更新</div>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <div style="display: flex; gap: 10px; align-items: flex-end;">
                            <div class="form-group" style="flex: 1; min-width: 200px;">
                                <label for="agent-version">Agent版本</label>
                                <select id="agent-version" class="form-control">
                                    <option value="latest">最新版本 (v3.2.1)</option>
                                    <option value="previous">上一版本 (v3.2.0)</option>
                                </select>
                            </div>
                            <div class="form-group" style="flex: 1; min-width: 200px;">
                                <label for="update-method">更新方式</label>
                                <select id="update-method" class="form-control">
                                    <option value="auto">自动更新</option>
                                    <option value="manual">手动触发</option>
                                    <option value="scheduled">计划任务</option>
                                </select>
                            </div>
                            <div class="form-group" style="min-width: 150px;">
                                <label>&nbsp;</label>
                                <button class="btn btn-primary" style="width: 100%;" onclick="updateAgents()"><i class="fas fa-play"></i> 开始更新</button>
                            </div>
                        </div>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>终端名称</th>
                                <th>当前版本</th>
                                <th>最新版本</th>
                                <th>状态</th>
                                <th>上次更新时间</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>SRV-AD-01</td>
                                <td>v3.2.0</td>
                                <td>v3.2.1</td>
                                <td><span class="tag tag-warning">可更新</span></td>
                                <td>2025-08-01 14:30:00</td>
                                <td class="table-actions">
                                    <button class="btn btn-outline btn-sm" onclick="updateSingleAgent('SRV-AD-01')"><i class="fas fa-sync-alt"></i> 立即更新</button>
                                </td>
                            </tr>
                            <tr>
                                <td>PC-IT-01</td>
                                <td>v3.2.1</td>
                                <td>v3.2.1</td>
                                <td><span class="tag tag-success">最新</span></td>
                                <td>2025-08-25 09:15:00</td>
                                <td class="table-actions">
                                    <button class="btn btn-outline btn-sm" disabled><i class="fas fa-check"></i> 已最新</button>
                                </td>
                            </tr>
                            <tr>
                                <td>PC-FIN-05</td>
                                <td>v3.1.5</td>
                                <td>v3.2.1</td>
                                <td><span class="tag tag-warning">可更新</span></td>
                                <td>2025-07-10 16:45:00</td>
                                <td class="table-actions">
                                    <button class="btn btn-outline btn-sm" onclick="updateSingleAgent('PC-FIN-05')"><i class="fas fa-sync-alt"></i> 立即更新</button>
                                </td>
                            </tr>
                            <tr>
                                <td>SRV-WEB-02</td>
                                <td>v3.2.0</td>
                                <td>v3.2.1</td>
                                <td><span class="tag tag-warning">可更新</span></td>
                                <td>2025-08-15 11:20:00</td>
                                <td class="table-actions">
                                    <button class="btn btn-outline btn-sm" onclick="updateSingleAgent('SRV-WEB-02')"><i class="fas fa-sync-alt"></i> 立即更新</button>
                                </td>
                            </tr>
                            <tr>
                                <td>PC-MKT-03</td>
                                <td>v3.2.1</td>
                                <td>v3.2.1</td>
                                <td><span class="tag tag-success">最新</span></td>
                                <td>2025-08-24 15:30:00</td>
                                <td class="table-actions">
                                    <button class="btn btn-outline btn-sm" disabled><i class="fas fa-check"></i> 已最新</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="pagination">
                        <button class="page-btn"><i class="fas fa-chevron-left"></i></button>
                        <button class="page-btn active">1</button>
                        <button class="page-btn">2</button>
                        <button class="page-btn">3</button>
                        <button class="page-btn"><i class="fas fa-chevron-right"></i></button>
                    </div>
                </div>
            </div>

            <!-- 备份与恢复 -->
            <div id="backup-restore" class="management-content">
                <div class="card">
                    <div class="panel-header">
                        <div class="panel-title">备份管理</div>
                        <button class="btn btn-primary" onclick="createBackup()"><i class="fas fa-plus"></i> 创建备份</button>
                    </div>
                    <div class="form-group" style="margin-bottom: 20px;">
                        <label>自动备份设置</label>
                        <div style="display: flex; align-items: center; margin-top: 8px;">
                            <label style="display: flex; align-items: center; gap: 5px; margin-right: 20px;">
                                <input type="checkbox" checked> 启用自动备份
                            </label>
                            <select class="form-control" style="width: auto; margin-right: 10px;">
                                <option value="daily">每天</option>
                                <option value="weekly" selected>每周</option>
                                <option value="monthly">每月</option>
                            </select>
                            <select class="form-control" style="width: auto; margin-right: 10px;">
                                <option value="00:00">00:00</option>
                                <option value="03:00">03:00</option>
                                <option value="06:00">06:00</option>
                                <option value="09:00" selected>09:00</option>
                                <option value="12:00">12:00</option>
                                <option value="15:00">15:00</option>
                                <option value="18:00">18:00</option>
                                <option value="21:00">21:00</option>
                            </select>
                            <button class="btn btn-outline btn-sm" onclick="saveBackupSettings()"><i class="fas fa-save"></i> 保存设置</button>
                        </div>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>备份名称</th>
                                <th>类型</th>
                                <th>大小</th>
                                <th>创建时间</th>
                                <th>状态</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>backup_20250820_full</td>
                                <td>完整备份</td>
                                <td>1.2 GB</td>
                                <td>2025-08-20 09:00:00</td>
                                <td><span class="tag tag-success">完成</span></td>
                                <td class="table-actions">
                                    <button class="btn btn-outline btn-sm" onclick="downloadBackup('backup_20250820_full')"><i class="fas fa-download"></i> 下载</button>
                                    <button class="btn btn-outline btn-sm" onclick="restoreFromBackup('backup_20250820_full')"><i class="fas fa-undo"></i> 恢复</button>
                                    <button class="btn btn-danger btn-sm" onclick="deleteBackup('backup_20250820_full')"><i class="fas fa-trash"></i> 删除</button>
                                </td>
                            </tr>
                            <tr>
                                <td>backup_20250813_full</td>
                                <td>完整备份</td>
                                <td>1.1 GB</td>
                                <td>2025-08-13 09:00:00</td>
                                <td><span class="tag tag-success">完成</span></td>
                                <td class="table-actions">
                                    <button class="btn btn-outline btn-sm" onclick="downloadBackup('backup_20250813_full')"><i class="fas fa-download"></i> 下载</button>
                                    <button class="btn btn-outline btn-sm" onclick="restoreFromBackup('backup_20250813_full')"><i class="fas fa-undo"></i> 恢复</button>
                                    <button class="btn btn-danger btn-sm" onclick="deleteBackup('backup_20250813_full')"><i class="fas fa-trash"></i> 删除</button>
                                </td>
                            </tr>
                            <tr>
                                <td>backup_20250806_full</td>
                                <td>完整备份</td>
                                <td>1.0 GB</td>
                                <td>2025-08-06 09:00:00</td>
                                <td><span class="tag tag-success">完成</span></td>
                                <td class="table-actions">
                                    <button class="btn btn-outline btn-sm" onclick="downloadBackup('backup_20250806_full')"><i class="fas fa-download"></i> 下载</button>
                                    <button class="btn btn-outline btn-sm" onclick="restoreFromBackup('backup_20250806_full')"><i class="fas fa-undo"></i> 恢复</button>
                                    <button class="btn btn-danger btn-sm" onclick="deleteBackup('backup_20250806_full')"><i class="fas fa-trash"></i> 删除</button>
                                </td>
                            </tr>
                            <tr>
                                <td>manual_backup_20250810</td>
                                <td>配置备份</td>
                                <td>12 MB</td>
                                <td>2025-08-10 16:45:22</td>
                                <td><span class="tag tag-success">完成</span></td>
                                <td class="table-actions">
                                    <button class="btn btn-outline btn-sm" onclick="downloadBackup('manual_backup_20250810')"><i class="fas fa-download"></i> 下载</button>
                                    <button class="btn btn-outline btn-sm" onclick="restoreFromBackup('manual_backup_20250810')"><i class="fas fa-undo"></i> 恢复</button>
                                    <button class="btn btn-danger btn-sm" onclick="deleteBackup('manual_backup_20250810')"><i class="fas fa-trash"></i> 删除</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="card">
                    <div class="panel-header">
                        <div class="panel-title">恢复操作</div>
                    </div>
                    <div style="padding: 10px 0;">
                        <div class="form-group">
                            <label for="restore-type">恢复类型</label>
                            <select id="restore-type" class="form-control">
                                <option value="full">完整恢复</option>
                                <option value="config">仅恢复配置</option>
                                <option value="intelligence">仅恢复威胁情报</option>
                                <option value="events">仅恢复事件数据</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>从本地文件恢复</label>
                            <div style="display: flex; gap: 10px; align-items: center;">
                                <input type="file" id="restore-file" class="form-control" style="flex: 1;">
                                <button class="btn btn-primary" onclick="restoreFromFile()"><i class="fas fa-undo"></i> 开始恢复</button>
                            </div>
                            <div class="form-hint">支持从本地备份文件恢复系统数据，仅支持.zip格式的备份文件</div>
                        </div>
                    </div>
                    <div style="background-color: #fef3c7; padding: 15px; border-radius: 4px; margin-top: 10px;">
                        <div style="display: flex; align-items: flex-start; gap: 10px;">
                            <i class="fas fa-exclamation-triangle" style="color: #d97706; margin-top: 2px;"></i>
                            <div>
                                <div style="font-weight: 600; margin-bottom: 5px; color: #b45309;">恢复注意事项</div>
                                <ul style="margin-left: 20px; line-height: 1.5; font-size: 14px; color: #92400e;">
                                    <li>恢复操作会覆盖现有数据，请谨慎操作</li>
                                    <li>完整恢复可能需要较长时间，请耐心等待</li>
                                    <li>恢复过程中系统可能无法正常使用</li>
                                    <li>建议在执行恢复操作前创建当前系统的备份</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 用户管理弹窗 -->
    <div class="modal" id="userModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="userModalTitle">添加用户</h3>
                <button class="modal-close" onclick="closeUserModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="userForm">
                    <div class="form-group">
                        <label for="user-username">用户名 <span style="color: #e74c3c;">*</span></label>
                        <input type="text" id="user-username" class="form-control" required>
                        <div class="form-hint">只能包含字母、数字和下划线，长度3-20字符</div>
                    </div>
                    <div class="form-group">
                        <label for="user-fullname">姓名 <span style="color: #e74c3c;">*</span></label>
                        <input type="text" id="user-fullname" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="user-email">邮箱 <span style="color: #e74c3c;">*</span></label>
                        <input type="email" id="user-email" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="user-role">角色 <span style="color: #e74c3c;">*</span></label>
                        <select id="user-role" class="form-control" required>
                            <option value="">请选择角色</option>
                            <option value="admin">管理员</option>
                            <option value="analyst">安全分析师</option>
                            <option value="operator">操作员</option>
                            <option value="viewer">查看者</option>
                        </select>
                    </div>
                    <div class="form-group" id="password-group">
                        <label for="user-password">密码 <span style="color: #e74c3c;">*</span></label>
                        <input type="password" id="user-password" class="form-control" required>
                        <div class="form-hint">密码长度至少8位，包含大小写字母、数字和特殊字符</div>
                    </div>
                    <div class="form-group">
                        <label>状态</label>
                        <div style="display: flex; align-items: center; gap: 10px; margin-top: 5px;">
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="radio" name="user-status" value="active" checked> 启用
                            </label>
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="radio" name="user-status" value="inactive"> 禁用
                            </label>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeUserModal()">取消</button>
                <button class="btn btn-primary" onclick="saveUser()"><i class="fas fa-save"></i> 保存</button>
            </div>
        </div>
    </div>

    <!-- 角色管理弹窗 -->
    <div class="modal" id="roleModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="roleModalTitle">创建角色</h3>
                <button class="modal-close" onclick="closeRoleModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="roleForm">
                    <div class="form-group">
                        <label for="role-name">角色名称 <span style="color: #e74c3c;">*</span></label>
                        <input type="text" id="role-name" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="role-description">角色描述</label>
                        <textarea id="role-description" class="form-control"></textarea>
                        <div class="form-hint">描述该角色的职责和权限范围</div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeRoleModal()">取消</button>
                <button class="btn btn-primary" onclick="saveRole()"><i class="fas fa-save"></i> 保存</button>
            </div>
        </div>
    </div>

    <!-- 系统更新弹窗 -->
    <div class="modal" id="updateModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>系统更新</h3>
                <button class="modal-close" onclick="closeUpdateModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div style="margin-bottom: 20px;">
                    <div style="font-weight: 600; margin-bottom: 10px;">更新信息</div>
                    <div style="line-height: 1.6;">
                        <div><strong>当前版本：</strong>v2.5.3 (Build 20250815)</div>
                        <div><strong>目标版本：</strong>v2.6.0 (Build 20250825)</div>
                        <div><strong>更新大小：</strong>356 MB</div>
                        <div><strong>预计时间：</strong>15-20分钟</div>
                    </div>
                </div>
                <div style="background-color: #fef3c7; padding: 15px; border-radius: 4px; margin-bottom: 20px;">
                    <div style="display: flex; align-items: flex-start; gap: 10px;">
                        <i class="fas fa-exclamation-triangle" style="color: #d97706; margin-top: 2px;"></i>
                        <div>
                            <div style="font-weight: 600; margin-bottom: 5px; color: #b45309;">更新注意事项</div>
                            <ul style="margin-left: 20px; line-height: 1.5; font-size: 14px; color: #92400e;">
                                <li>系统更新过程中服务将暂时中断</li>
                                <li>请确保服务器有稳定的网络连接</li>
                                <li>建议在更新前创建系统备份</li>
                                <li>请勿在更新过程中关闭浏览器或重启服务器</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                    <input type="checkbox" id="confirm-backup" required>
                    <label for="confirm-backup">我已确认已创建系统备份，并了解更新风险</label>
                </div>
                <div id="update-progress" style="display: none;">
                    <div style="margin-bottom: 5px; display: flex; justify-content: space-between;">
                        <span>正在下载更新...</span>
                        <span id="update-percentage">0%</span>
                    </div>
                    <div class="progress-container">
                        <div class="progress-bar progress-success" id="update-progress-bar" style="width: 0%;"></div>
                    </div>
                    <div id="update-status" style="margin-top: 10px; font-size: 14px; text-align: center;"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeUpdateModal()">取消</button>
                <button class="btn btn-warning" id="start-update-btn" onclick="startSystemUpdate()"><i class="fas fa-download"></i> 开始更新</button>
            </div>
        </div>
    </div>

    <script>

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 初始化图表
            initResourceMonitoringChart();
            initLogStatisticsChart();
            
            // 为所有树节点添加点击事件
            const treeNodes = document.querySelectorAll('.tree-node.has-children > .menu-item');
            treeNodes.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const treeNode = this.closest('.tree-node');
                    treeNode.classList.toggle('expanded');
                });
            });
            
            // 绑定菜单项点击事件
            const menuItems = document.querySelectorAll('.menu-item[data-target]');
            menuItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.stopPropagation();
                    
                    // 移除所有菜单项的active类
                    menuItems.forEach(menu => menu.classList.remove('active'));
                    // 给当前点击的菜单项添加active类
                    this.classList.add('active');
                    
                    // 更新面包屑
                    updateBreadcrumb(this);
                    
                    // 隐藏所有管理内容
                    const managementContents = document.querySelectorAll('.management-content');
                    managementContents.forEach(content => content.classList.remove('active'));
                    
                    // 显示对应的管理内容
                    const targetId = this.getAttribute('data-target');
                    document.getElementById(targetId).classList.add('active');
                    
                    // 如果是系统状态页面，初始化资源监控图表
                    if (targetId === 'system-status') {
                        initResourceMonitoringChart();
                    }
                    
                    // 如果是日志审计页面，初始化日志统计图表
                    if (targetId === 'log-audit') {
                        initLogStatisticsChart();
                    }
                });
            });
        });

        // 更新面包屑导航
        function updateBreadcrumb(menuItem) {
            const breadcrumb = [];
            let currentNode = menuItem.closest('.tree-node');
            
            // 收集当前节点及其所有父节点的文本
            while (currentNode && currentNode.classList.contains('tree-node')) {
                const text = currentNode.querySelector('.menu-item span').textContent;
                breadcrumb.unshift(text);
                currentNode = currentNode.parentElement.closest('.tree-node');
            }
            
            // 更新面包屑显示
            document.getElementById('management-breadcrumb').textContent = breadcrumb.join(' / ');
        }

        // 初始化资源监控图表
        function initResourceMonitoringChart() {
            const ctx = document.getElementById('resourceMonitoringChart').getContext('2d');
            
            // 生成过去24小时的时间标签
            const labels = [];
            const now = new Date();
            for (let i = 23; i >= 0; i--) {
                const hour = new Date(now.getTime() - i * 60 * 60 * 1000);
                labels.push(`${hour.getHours()}:00`);
            }
            
            // 生成随机数据
            const cpuData = generateRandomData(24, 10, 60);
            const memoryData = generateRandomData(24, 30, 70);
            const diskIOData = generateRandomData(24, 5, 40);
            
            const chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'CPU 使用率 (%)',
                            data: cpuData,
                            borderColor: 'rgba(231, 76, 60, 1)',
                            backgroundColor: 'rgba(231, 76, 60, 0.1)',
                            tension: 0.3,
                            fill: true
                        },
                        {
                            label: '内存使用率 (%)',
                            data: memoryData,
                            borderColor: 'rgba(52, 152, 219, 1)',
                            backgroundColor: 'rgba(52, 152, 219, 0.1)',
                            tension: 0.3,
                            fill: true
                        },
                        {
                            label: '磁盘IO使用率 (%)',
                            data: diskIOData,
                            borderColor: 'rgba(46, 204, 113, 1)',
                            backgroundColor: 'rgba(46, 204, 113, 0.1)',
                            tension: 0.3,
                            fill: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: '系统资源使用率趋势'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    }
                }
            });
        }

        // 初始化日志统计图表
        function initLogStatisticsChart() {
            const ctx = document.getElementById('logStatisticsChart').getContext('2d');
            
            const chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['周一', '周二', '周三', '周四', '周五', '周六', '周日'],
                    datasets: [
                        {
                            label: '登录操作',
                            data: [45, 52, 49, 63, 58, 23, 18],
                            backgroundColor: 'rgba(52, 152, 219, 0.7)',
                        },
                        {
                            label: '配置修改',
                            data: [12, 8, 15, 10, 18, 5, 3],
                            backgroundColor: 'rgba(243, 156, 18, 0.7)',
                        },
                        {
                            label: '数据查询',
                            data: [128, 145, 132, 165, 152, 65, 42],
                            backgroundColor: 'rgba(46, 204, 113, 0.7)',
                        },
                        {
                            label: '失败操作',
                            data: [5, 3, 8, 2, 6, 1, 0],
                            backgroundColor: 'rgba(231, 76, 60, 0.7)',
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: '操作日志统计'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                precision: 0
                            }
                        }
                    }
                }
            });
        }

        // 更新资源监控图表
        function updateResourceChart(range) {
            showToast(`已更新为${range === '1h' ? '近1小时' : range === '24h' ? '近24小时' : '近7天'}的资源监控数据`);
            // 实际应用中，这里会根据选择的时间范围更新图表数据
        }

        // 更新日志统计图表
        function updateLogChart(period) {
            showToast(`已更新为${period === 'day' ? '按天' : period === 'week' ? '按周' : '按月'}的日志统计数据`);
            // 实际应用中，这里会根据选择的周期更新图表数据
        }

        // 重启服务
        function restartService(serviceName) {
            showToast(`正在重启${serviceName}...`);
            // 模拟服务重启
            setTimeout(() => {
                showToast(`${serviceName}重启成功`);
            }, 1500);
        }

        // 启动服务
        function startService(serviceName) {
            showToast(`正在启动${serviceName}...`);
            // 模拟服务启动
            setTimeout(() => {
                showToast(`${serviceName}启动成功`);
            }, 1000);
        }

        // 保存设置
        function saveSettings(settingType) {
            const settingNames = {
                'basic': '基本设置',
                'alert': '告警设置',
                'intelligence': '威胁情报源设置'
            };
            showToast(`正在保存${settingNames[settingType]}...`);
            // 模拟保存设置
            setTimeout(() => {
                showToast(`${settingNames[settingType]}保存成功`);
            }, 800);
        }

        // 同步威胁情报
        function syncIntelligence() {
            showToast('正在同步威胁情报...');
            // 模拟同步过程
            setTimeout(() => {
                showToast('威胁情报同步完成');
            }, 2000);
        }

        // 显示用户弹窗
        function showUserModal() {
            document.getElementById('userModalTitle').textContent = '添加用户';
            document.getElementById('password-group').style.display = 'block';
            document.getElementById('userForm').reset();
            document.getElementById('userModal').classList.add('active');
        }

        // 编辑用户
        function editUser(username) {
            document.getElementById('userModalTitle').textContent = `编辑用户: ${username}`;
            document.getElementById('password-group').style.display = 'none';
            // 填充表单数据（模拟）
            document.getElementById('user-username').value = username;
            // 根据用户名填充不同的示例数据
            if (username === 'admin') {
                document.getElementById('user-fullname').value = '系统管理员';
                document.getElementById('user-email').value = 'admin@example.com';
                document.getElementById('user-role').value = 'admin';
                document.querySelector('input[name="user-status"][value="active"]').checked = true;
            } else if (username === 'security_analyst') {
                document.getElementById('user-fullname').value = '安全分析师';
                document.getElementById('user-email').value = 'analyst@example.com';
                document.getElementById('user-role').value = 'analyst';
                document.querySelector('input[name="user-status"][value="active"]').checked = true;
            } else {
                document.getElementById('user-fullname').value = '测试用户';
                document.getElementById('user-email').value = 'test@example.com';
                document.getElementById('user-role').value = 'operator';
                document.querySelector('input[name="user-status"][value="active"]').checked = true;
            }
            document.getElementById('userModal').classList.add('active');
        }

        // 关闭用户弹窗
        function closeUserModal() {
          document.getElementById('userModal').classList.remove('active');
        }
    
        // 保存用户
        function saveUser() {
            const username = document.getElementById('user-username').value;
            const isNewUser = document.getElementById('userModalTitle').textContent === '添加用户';
            
            if (!username) {
                showToast('请输入用户名', 'error');
                return;
            }
            
            showToast(`${isNewUser ? '正在创建用户' : '正在更新用户'}: ${username}...`);
            // 模拟保存用户
            setTimeout(() => {
                showToast(`${isNewUser ? '用户创建' : '用户更新'}成功: ${username}`);
                closeUserModal();
            }, 1000);
        }
    
        // 重置密码
        function resetPassword(username) {
            if (confirm(`确定要重置用户 "${username}" 的密码吗？`)) {
                showToast(`正在重置用户 "${username}" 的密码...`);
                // 模拟密码重置
                setTimeout(() => {
                    showToast(`用户 "${username}" 的密码已重置为默认密码: P@ssw0rd`);
                }, 800);
            }
        }
    
        // 禁用用户
        function disableUser(username) {
            if (confirm(`确定要禁用用户 "${username}" 吗？禁用后该用户将无法登录系统。`)) {
                showToast(`正在禁用用户 "${username}"...`);
                // 模拟禁用用户
                setTimeout(() => {
                    showToast(`用户 "${username}" 已禁用`);
                }, 800);
            }
        }
    
        // 启用用户
        function enableUser(username) {
            showToast(`正在启用用户 "${username}"...`);
            // 模拟启用用户
            setTimeout(() => {
                showToast(`用户 "${username}" 已启用`);
            }, 800);
        }
    
        // 显示角色弹窗
        function showRoleModal() {
            document.getElementById('roleModalTitle').textContent = '创建角色';
            document.getElementById('roleForm').reset();
            document.getElementById('roleModal').classList.add('active');
        }
    
        // 编辑角色
        function editRole(roleName) {
            document.getElementById('roleModalTitle').textContent = `编辑角色: ${roleName}`;
            // 填充表单数据（模拟）
            document.getElementById('role-name').value = roleName;
            if (roleName === '管理员') {
                document.getElementById('role-description').value = '系统最高权限，可访问和管理所有功能';
            } else if (roleName === '安全分析师') {
                document.getElementById('role-description').value = '可查看和分析安全事件，管理威胁情报';
            } else {
                document.getElementById('role-description').value = '角色描述信息';
            }
            document.getElementById('roleModal').classList.add('active');
        }
    
        // 关闭角色弹窗
        function closeRoleModal() {
            document.getElementById('roleModal').classList.remove('active');
        }
    
        // 保存角色
        function saveRole() {
            const roleName = document.getElementById('role-name').value;
            const isNewRole = document.getElementById('roleModalTitle').textContent === '创建角色';
            
            if (!roleName) {
                showToast('请输入角色名称', 'error');
                return;
            }
            
            showToast(`${isNewRole ? '正在创建角色' : '正在更新角色'}: ${roleName}...`);
            // 模拟保存角色
            setTimeout(() => {
                showToast(`${isNewRole ? '角色创建' : '角色更新'}成功: ${roleName}`);
                closeRoleModal();
            }, 1000);
        }
    
        // 查看角色用户
        function viewRoleUsers(roleName) {
            showToast(`正在加载角色 "${roleName}" 的用户列表...`);
            // 模拟加载用户列表
            setTimeout(() => {
                alert(`角色 "${roleName}" 的用户列表：\n- 用户1\n- 用户2\n- 用户3`);
            }, 800);
        }
    
        // 删除角色
        function deleteRole(roleName) {
            if (confirm(`确定要删除角色 "${roleName}" 吗？删除后将无法恢复。`)) {
                showToast(`正在删除角色 "${roleName}"...`);
                // 模拟删除角色
                setTimeout(() => {
                    showToast(`角色 "${roleName}" 已删除`);
                }, 800);
            }
        }
    
        // 加载角色权限
        function loadRolePermissions(role) {
            const roleNames = {
                'admin': '管理员',
                'analyst': '安全分析师',
                'operator': '操作员',
                'viewer': '查看者',
                'auditor': '审计员'
            };
            showToast(`正在加载 ${roleNames[role]} 的权限设置...`);
            // 实际应用中，这里会根据选择的角色加载对应的权限设置
        }
    
        // 保存角色权限
        function saveRolePermissions() {
            showToast('正在保存权限设置...');
            // 模拟保存权限设置
            setTimeout(() => {
                showToast('权限设置保存成功');
            }, 1000);
        }
    
        // 搜索日志
        function searchLogs() {
            showToast('正在搜索日志...');
            // 模拟搜索日志
            setTimeout(() => {
                showToast('日志搜索完成，找到 24 条匹配记录');
            }, 1200);
        }
    
        // 重置日志筛选条件
        function resetLogFilters() {
            document.getElementById('log-user').value = '';
            document.getElementById('log-action').value = 'all';
            document.getElementById('log-result').value = 'all';
            document.getElementById('log-start-time').value = '';
            document.getElementById('log-end-time').value = '';
            showToast('日志筛选条件已重置');
        }
    
        // 导出日志
        function exportLogs() {
            showToast('正在导出日志数据...');
            // 模拟导出日志
            setTimeout(() => {
                showToast('日志导出成功，共导出 156 条记录');
            }, 1500);
        }
    
        // 检查更新
        function checkForUpdates() {
            showToast('正在检查更新...');
            // 模拟检查更新
            setTimeout(() => {
                showToast('检查更新完成，当前有可用的系统更新');
            }, 1500);
        }
    
        // 显示更新弹窗
        function showUpdateModal() {
            document.getElementById('updateModal').classList.add('active');
        }
    
        // 关闭更新弹窗
        function closeUpdateModal() {
            document.getElementById('updateModal').classList.remove('active');
        }
    
        // 开始系统更新
        function startSystemUpdate() {
            if (!document.getElementById('confirm-backup').checked) {
                showToast('请确认已创建系统备份', 'error');
                return;
            }
            
            // 隐藏开始更新按钮，显示进度条
            document.getElementById('start-update-btn').style.display = 'none';
            document.getElementById('update-progress').style.display = 'block';
            
            // 模拟更新进度
            let progress = 0;
            const progressBar = document.getElementById('update-progress-bar');
            const percentageText = document.getElementById('update-percentage');
            const statusText = document.getElementById('update-status');
            
            const updateInterval = setInterval(() => {
                progress += Math.random() * 5;
                if (progress > 100) progress = 100;
                
                progressBar.style.width = `${progress}%`;
                percentageText.textContent = `${Math.round(progress)}%`;
                
                if (progress < 30) {
                    statusText.textContent = '正在下载更新包...';
                } else if (progress < 60) {
                    statusText.textContent = '正在验证更新包...';
                } else if (progress < 90) {
                    statusText.textContent = '正在安装更新...';
                } else {
                    statusText.textContent = '更新完成，正在重启服务...';
                }
                
                if (progress === 100) {
                    clearInterval(updateInterval);
                    setTimeout(() => {
                        showToast('系统更新完成，已升级至最新版本');
                        closeUpdateModal();
                        // 恢复按钮显示状态
                        document.getElementById('start-update-btn').style.display = 'inline-flex';
                        document.getElementById('update-progress').style.display = 'none';
                        progressBar.style.width = '0%';
                    }, 2000);
                }
            }, 500);
        }
    
        // 更新所有终端Agent
        function updateAgents() {
            const version = document.getElementById('agent-version').value;
            const method = document.getElementById('update-method').value;
            
            const versionText = version === 'latest' ? '最新版本' : '上一版本';
            const methodText = method === 'auto' ? '自动更新' : method === 'manual' ? '手动触发' : '计划任务';
            
            showToast(`正在${methodText}终端Agent至${versionText}...`);
            // 模拟更新终端Agent
            setTimeout(() => {
                showToast(`终端Agent${methodText}已启动，将逐步完成所有终端的更新`);
            }, 1500);
        }
    
        // 更新单个终端Agent
        function updateSingleAgent(agentName) {
            showToast(`正在更新终端 ${agentName} 的Agent...`);
            // 模拟更新单个终端Agent
            setTimeout(() => {
                showToast(`终端 ${agentName} 的Agent更新完成`);
            }, 1000);
        }
    
        // 创建备份
        function createBackup() {
            if (confirm('确定要创建系统备份吗？此操作可能需要几分钟时间。')) {
                showToast('正在创建系统备份...');
                // 模拟创建备份
                setTimeout(() => {
                    showToast('系统备份创建成功');
                }, 2500);
            }
        }
    
        // 保存备份设置
        function saveBackupSettings() {
            showToast('正在保存自动备份设置...');
            // 模拟保存备份设置
            setTimeout(() => {
                showToast('自动备份设置保存成功');
            }, 800);
        }
    
        // 下载备份
        function downloadBackup(backupName) {
            showToast(`正在准备下载备份 ${backupName}...`);
            // 模拟下载备份
            setTimeout(() => {
                showToast(`备份 ${backupName} 下载完成`);
            }, 2000);
        }
    
        // 从备份恢复
        function restoreFromBackup(backupName) {
            if (confirm(`确定要从备份 ${backupName} 恢复系统吗？此操作将覆盖当前系统数据！`)) {
                showToast(`正在从备份 ${backupName} 恢复系统...`);
                // 模拟从备份恢复
                setTimeout(() => {
                    showToast(`从备份 ${backupName} 恢复系统成功`);
                }, 3000);
            }
        }
    
        // 从文件恢复
        function restoreFromFile() {
            const fileName = document.getElementById('restore-file').files[0]?.name;
            if (!fileName) {
                showToast('请选择要恢复的备份文件', 'error');
                return;
            }
            
            if (confirm(`确定要从文件 ${fileName} 恢复系统吗？此操作将覆盖当前系统数据！`)) {
                showToast(`正在从文件 ${fileName} 恢复系统...`);
                // 模拟从文件恢复
                setTimeout(() => {
                    showToast(`从文件 ${fileName} 恢复系统成功`);
                }, 3000);
            }
        }
    
        // 删除备份
        function deleteBackup(backupName) {
            if (confirm(`确定要删除备份 ${backupName} 吗？删除后将无法恢复。`)) {
                showToast(`正在删除备份 ${backupName}...`);
                // 模拟删除备份
                setTimeout(() => {
                    showToast(`备份 ${backupName} 已删除`);
                }, 1000);
            }
        }
    
        // 显示提示消息
        function showToast(message, type = 'info') {
            // 创建toast元素
            const toast = document.createElement('div');
            toast.className = 'toast';
            
            // 根据类型添加图标
            let icon = '';
            switch(type) {
                case 'success':
                    icon = '<i class="fas fa-check-circle"></i> ';
                    break;
                case 'error':
                    icon = '<i class="fas fa-times-circle"></i> ';
                    toast.style.backgroundColor = 'rgba(231, 76, 60, 0.8)';
                    break;
                case 'warning':
                    icon = '<i class="fas fa-exclamation-circle"></i> ';
                    toast.style.backgroundColor = 'rgba(243, 156, 18, 0.8)';
                    break;
                default:
                    icon = '<i class="fas fa-info-circle"></i> ';
            }
            
            toast.innerHTML = icon + message;
            document.body.appendChild(toast);
            
            // 3秒后移除toast
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }
    
        // 生成指定范围的随机数据
        function generateRandomData(count, min, max) {
            return Array.from({length: count}, () => Math.floor(Math.random() * (max - min + 1)) + min);
        }
        
        // 初始化CPU核心监控图表
        function initCPUCoreChart() {
            const ctx = document.getElementById('cpuCoreChart').getContext('2d');
            
            // 生成过去24小时的时间标签
            const labels = [];
            const now = new Date();
            for (let i = 23; i >= 0; i--) {
                const hour = new Date(now.getTime() - i * 60 * 60 * 1000);
                labels.push(`${hour.getHours()}:00`);
            }
            
            // 为8个核心生成随机数据
            const datasets = [];
            const colors = [
                'rgba(231, 76, 60, 0.7)',
                'rgba(52, 152, 219, 0.7)',
                'rgba(46, 204, 113, 0.7)',
                'rgba(243, 156, 18, 0.7)',
                'rgba(155, 89, 182, 0.7)',
                'rgba(52, 73, 94, 0.7)',
                'rgba(230, 126, 34, 0.7)',
                'rgba(26, 188, 156, 0.7)'
            ];
            
            for (let i = 0; i < 8; i++) {
                datasets.push({
                    label: `CPU核心 ${i+1}`,
                    data: generateRandomData(24, 5, 70),
                    backgroundColor: colors[i],
                    borderColor: colors[i].replace('0.7', '1'),
                    borderWidth: 1,
                    tension: 0.3
                });
            }
            
            const chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: '各CPU核心使用率趋势 (%)'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    }
                }
            });
        }

        // 更新CPU核心监控图表
        function updateCPUCoreChart(range) {
            showToast(`已更新为${range === '1h' ? '近1小时' : range === '24h' ? '近24小时' : '近7天'}的CPU核心监控数据`);
            // 实际应用中，这里会根据选择的时间范围更新图表数据
        }

        // 在页面初始化时添加CPU核心图表初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 原有的初始化代码...
            initCPUCoreChart();
        });
    </script>
</body>
</html>