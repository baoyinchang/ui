<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èœå•ç»“æ„æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin: 10px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .menu-structure {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 15px;
            font-family: monospace;
            white-space: pre-line;
        }
        .success { color: #28a745; }
        .error { color: #dc3545; }
        .warning { color: #ffc107; }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <h1>ğŸ” H-System EDR èœå•ç»“æ„æµ‹è¯•</h1>
    
    <div class="test-card">
        <h2>é¢„æœŸèœå•ç»“æ„</h2>
        <div class="menu-structure">
H-System EDR èœå•ç»“æ„

ä¸»èœå•:
â”œâ”€â”€ å®‰å…¨æ€åŠ¿ (/dashboard)
â”œâ”€â”€ å‘Šè­¦ä¸­å¿ƒ (/alerts)
â”œâ”€â”€ è°ƒæŸ¥ä¸å“åº” (/investigation)
â”œâ”€â”€ èµ„äº§ç®¡ç† (/assets)
â”œâ”€â”€ å¨èƒç‹©çŒ (/hunting)
â”œâ”€â”€ å¨èƒæƒ…æŠ¥ (/intelligence)
â”œâ”€â”€ æŠ¥å‘Šä¸­å¿ƒ (/reports)
â””â”€â”€ ç³»ç»Ÿç®¡ç† (/system) â­ æœ‰å­èœå•
    â”œâ”€â”€ ç³»ç»ŸçŠ¶æ€ (/system/status)
    â”œâ”€â”€ ç³»ç»Ÿè®¾ç½® (/system/settings)
    â”œâ”€â”€ ç”¨æˆ·ç®¡ç† (/system/users)
    â”œâ”€â”€ è§’è‰²ä¸æƒé™ (/system/roles)
    â”œâ”€â”€ èœœç½ç­–ç•¥ä¸­å¿ƒ (/system/honeypot)
    â””â”€â”€ æ—¥å¿—å®¡è®¡ (/system/logs)
        </div>
    </div>
    
    <div class="test-card">
        <h2>èœå•æµ‹è¯•</h2>
        <button onclick="testMenuStructure()">æµ‹è¯•èœå•ç»“æ„</button>
        <button onclick="testRouteNavigation()">æµ‹è¯•è·¯ç”±å¯¼èˆª</button>
        <button onclick="testPermissions()">æµ‹è¯•æƒé™æ§åˆ¶</button>
        <div id="test-results"></div>
    </div>

    <script>
        function log(message, type = 'info') {
            const results = document.getElementById('test-results');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.className = type;
            logEntry.innerHTML = `[${timestamp}] ${message}`;
            results.appendChild(logEntry);
        }

        function testMenuStructure() {
            document.getElementById('test-results').innerHTML = '';
            log('ğŸ” æµ‹è¯•èœå•ç»“æ„...', 'info');
            
            const testCode = `
// æµ‹è¯•èœå•ç»“æ„
const router = useRouter();
const layoutRoute = router.getRoutes().find(r => r.name === 'Layout');
const menuRoutes = layoutRoute?.children?.filter(r => !r.meta?.hideInMenu) || [];

console.log('=== èœå•ç»“æ„æµ‹è¯• ===');
console.log('èœå•è·¯ç”±æ•°é‡:', menuRoutes.length);

// æŸ¥æ‰¾ç³»ç»Ÿç®¡ç†è·¯ç”±
const systemRoute = menuRoutes.find(r => r.path === '/system');
if (systemRoute) {
    console.log('âœ… æ‰¾åˆ°ç³»ç»Ÿç®¡ç†è·¯ç”±');
    console.log('ç³»ç»Ÿç®¡ç†æ ‡é¢˜:', systemRoute.meta?.title);
    
    if (systemRoute.children && systemRoute.children.length > 0) {
        console.log('âœ… ç³»ç»Ÿç®¡ç†æœ‰å­èœå•');
        console.log('å­èœå•æ•°é‡:', systemRoute.children.length);
        
        systemRoute.children.forEach(child => {
            console.log(\`  - \${child.path}: \${child.meta?.title}\`);
        });
    } else {
        console.log('âŒ ç³»ç»Ÿç®¡ç†æ²¡æœ‰å­èœå•');
    }
} else {
    console.log('âŒ æœªæ‰¾åˆ°ç³»ç»Ÿç®¡ç†è·¯ç”±');
}

// æ£€æŸ¥ç”¨æˆ·ç®¡ç†æ˜¯å¦åœ¨ç³»ç»Ÿç®¡ç†ä¸‹
const userRoute = menuRoutes.find(r => r.path === '/users');
if (userRoute) {
    console.log('âš ï¸ ç”¨æˆ·ç®¡ç†ä»æ˜¯ç‹¬ç«‹èœå•é¡¹');
} else {
    console.log('âœ… ç”¨æˆ·ç®¡ç†å·²ç§»åˆ°ç³»ç»Ÿç®¡ç†ä¸‹');
}
            `;
            
            log('ğŸ’¡ åœ¨ä¸»åº”ç”¨é¡µé¢æ§åˆ¶å°ä¸­è¿è¡Œ:', 'info');
            log(testCode, 'info');
        }

        function testRouteNavigation() {
            document.getElementById('test-results').innerHTML = '';
            log('ğŸ” æµ‹è¯•è·¯ç”±å¯¼èˆª...', 'info');
            
            const navTestCode = `
// æµ‹è¯•è·¯ç”±å¯¼èˆª
const testRoutes = [
    '/system',
    '/system/status',
    '/system/settings',
    '/system/users',
    '/system/roles',
    '/system/honeypot',
    '/system/logs'
];

console.log('=== è·¯ç”±å¯¼èˆªæµ‹è¯• ===');

testRoutes.forEach(route => {
    try {
        $router.push(route);
        console.log(\`âœ… è·¯ç”± \${route} å¯¼èˆªæˆåŠŸ\`);
    } catch (error) {
        console.log(\`âŒ è·¯ç”± \${route} å¯¼èˆªå¤±è´¥: \${error.message}\`);
    }
});

// ç­‰å¾…ä¸€ä¸‹å†æ£€æŸ¥å½“å‰è·¯ç”±
setTimeout(() => {
    console.log('å½“å‰è·¯ç”±:', $route.path);
}, 1000);
            `;
            
            log('ğŸ’¡ åœ¨ä¸»åº”ç”¨é¡µé¢æ§åˆ¶å°ä¸­è¿è¡Œ:', 'info');
            log(navTestCode, 'info');
        }

        function testPermissions() {
            document.getElementById('test-results').innerHTML = '';
            log('ğŸ” æµ‹è¯•æƒé™æ§åˆ¶...', 'info');
            
            const permTestCode = `
// æµ‹è¯•æƒé™æ§åˆ¶
const userStore = useUserStore();

console.log('=== æƒé™æ§åˆ¶æµ‹è¯• ===');
console.log('è®¤è¯å¼€å…³:', import.meta.env.VITE_ENABLE_AUTH);

const systemPermissions = [
    'system:read',
    'system:write', 
    'user:read',
    'role:read',
    'honeypot:read',
    'log:read'
];

systemPermissions.forEach(perm => {
    const hasPermission = userStore.hasPermission(perm);
    console.log(\`æƒé™ \${perm}: \${hasPermission}\`);
});
            `;
            
            log('ğŸ’¡ åœ¨ä¸»åº”ç”¨é¡µé¢æ§åˆ¶å°ä¸­è¿è¡Œ:', 'info');
            log(permTestCode, 'info');
        }

        // é¡µé¢åŠ è½½æç¤º
        window.onload = function() {
            log('ğŸ“„ èœå•ç»“æ„æµ‹è¯•é¡µé¢å·²åŠ è½½', 'success');
            log('ğŸ’¡ è¯·åœ¨ä¸»åº”ç”¨é¡µé¢æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼Œç„¶åä½¿ç”¨æ­¤é¡µé¢çš„æµ‹è¯•æŒ‰é’®', 'info');
        };
    </script>
</body>
</html>