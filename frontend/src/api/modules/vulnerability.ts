// src/api/modules/vulnerability.ts
import { http } from '../request'
import type { PaginationParams, ApiResponse } from '@/types/api'
//import type { VulnerabilityResponse } from '../../../backend/app/api/v1/assets' // 根据实际路径调整

export interface VulnerabilityListParams extends PaginationParams {
  assetId?: number
  severity?: string
  status?: string
}

export const vulnerabilityApi = {
  /**
   * 获取漏洞列表
   */
  getList: (params: VulnerabilityListParams = {}) => {
    return http.get<ApiResponse<{
      items: any[]
      total: number
      page: number
      size: number
    }>>('/vulnerabilities', { params })
  },

  /**
   * 获取漏洞详情
   */
  getById: (id: number) => {
    return http.get<ApiResponse<any>>(`/vulnerabilities/${id}`)
  },

  /**
   * 更新漏洞状态
   */
  updateStatus: (id: number, status: string) => {
    return http.patch<ApiResponse<any>>(`/vulnerabilities/${id}/status`, { status })
  }
}